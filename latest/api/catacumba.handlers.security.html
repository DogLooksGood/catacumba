<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><title>catacumba.handlers.security documentation</title></head><body><header><section class="title"><h1><a href="index.html">Catacumba Api Documentation</a></h1></section><small>Version: 2.2.1</small></header><section class="container"><div class="sidebar" id="namespaces"><h3><a href="index.html"><span class="inner">Namespaces</span></a></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>catacumba</span></div></div></li><li class="depth-2 branch"><a href="catacumba.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handlers</span></div></div></li><li class="depth-3 branch"><a href="catacumba.handlers.auth.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>auth</span></div></a></li><li class="depth-3 branch"><a href="catacumba.handlers.misc.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>misc</span></div></a></li><li class="depth-3 branch"><a href="catacumba.handlers.parse.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>parse</span></div></a></li><li class="depth-3 branch"><a href="catacumba.handlers.restful.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>restful</span></div></a></li><li class="depth-3 branch current"><a href="catacumba.handlers.security.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>security</span></div></a></li><li class="depth-3"><a href="catacumba.handlers.session.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>session</span></div></a></li><li class="depth-2 branch"><a href="catacumba.http.html"><div class="inner"><span class="tree" style="top: -207px;"><span class="top" style="height: 216px;"></span><span class="bottom"></span></span><span>http</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>impl</span></div></div></li><li class="depth-3 branch"><a href="catacumba.impl.registry.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>registry</span></div></a></li><li class="depth-3"><a href="catacumba.impl.streams.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>streams</span></div></a></li><li class="depth-2 branch"><a href="catacumba.serializers.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>serializers</span></div></a></li><li class="depth-2"><a href="catacumba.testing.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>testing</span></div></a></li></ul></div><section class="namespace-docs" id="content"><h2 class="anchor" id="top">catacumba.handlers.security</h2><div class="doc"><div class="markdown"></div></div><div class="public anchor" id="var-content-type-options-headers"><h3><a href="#var-content-type-options-headers">content-type-options-headers</a></h3><div class="usage"><code>(content-type-options-headers context)</code></div><div class="doc"><div class="markdown"><p>A chain handler that adds the <code>X-Content-Type-Options</code> header to the response. It prevent resources with invalid media types being loaded as stylesheets or scripts.</p><p>This does not have any option.</p><p>More information: <a href="http://msdn.microsoft.com/en-us/library/ie/gg622941(v=vs.85).aspx">http://msdn.microsoft.com/en-us/library/ie/gg622941(v=vs.85).aspx</a> <a href="https://www.owasp.org/index.php/List_of_useful_HTTP_headers">https://www.owasp.org/index.php/List_of_useful_HTTP_headers</a></p></div></div><div class="src-link"><a href="http://github.com/funcool/catacumba/blob/master/src/clojure/catacumba/handlers/security.clj#L109">view source</a></div></div><div class="public anchor" id="var-csp-headers"><h3><a href="#var-csp-headers">csp-headers</a></h3><div class="usage"><code>(csp-headers)</code><code>(csp-headers options)</code></div><div class="doc"><div class="markdown"><p>A chain handler that adds Content-Security-Policy header to the response.</p><p>Content Security Policy (CSP) is an added layer of security that helps to detect and mitigate certain types of attacks, including Cross Site Scripting (XSS) and data injection attacks. These attacks are used for everything from data theft to site defacement or distribution of malware.</p><p>Example:</p>
<pre><code>(def cspconf {:default-src &quot;&#39;self&#39; *.trusted.com&quot;
              :img-src &quot;*&quot;
              :frame-ancestors &quot;&#39;none&#39;&quot;
              :reflected-xss &quot;filter&quot;})

(def app
  (ct/routes [[:prefix &quot;web&quot;
               [:all (csp-headers cspconf)]
               [:get your-handler]]]))
</code></pre><p>You can read more about that here: <a href="https://developer.mozilla.org/en-US/docs/Web/Security/CSP">https://developer.mozilla.org/en-US/docs/Web/Security/CSP</a></p></div></div><div class="src-link"><a href="http://github.com/funcool/catacumba/blob/master/src/clojure/catacumba/handlers/security.clj#L74">view source</a></div></div><div class="public anchor" id="var-csrf-protect"><h3><a href="#var-csrf-protect">csrf-protect</a></h3><div class="usage"><code>(csrf-protect)</code><code>(csrf-protect {:keys [on-error cookie-name field-name header-name], :or {header-name :x-csrftoken, field-name :csrftoken, cookie-name :csrftoken}})</code></div><div class="doc"><div class="markdown"><p>A chain handler that provides csrf (Cross-site request forgery) protection. Also known as a one-click attack or session riding.</p></div></div><div class="src-link"><a href="http://github.com/funcool/catacumba/blob/master/src/clojure/catacumba/handlers/security.clj#L153">view source</a></div></div><div class="public anchor" id="var-frame-options-headers"><h3><a href="#var-frame-options-headers">frame-options-headers</a></h3><div class="usage"><code>(frame-options-headers)</code><code>(frame-options-headers {:keys [policy], :or {policy :sameorigin}})</code></div><div class="doc"><div class="markdown"><p>A chain handler that adds X-Frame-Options header to the response.</p><p>The X-Frame-Options HTTP response header can be used to indicate whether or not a browser should be allowed to render a page in a <code>&lt;frame&gt;</code>, <code>&lt;iframe&gt;</code> or <code>&lt;object&gt;</code> . Sites can use this to avoid clickjacking attacks, by ensuring that their content is not embedded into other sites.</p><p>Possible options:</p>
<ul>
  <li><code>:policy</code>: with two possible values <code>:deny</code> and <code>:sameorigin</code></li>
</ul><p>Warning: The frame-ancestors directive from the CSP Level 2 specification officially replaces this non-standard header.</p></div></div><div class="src-link"><a href="http://github.com/funcool/catacumba/blob/master/src/clojure/catacumba/handlers/security.clj#L51">view source</a></div></div><div class="public anchor" id="var-hsts-headers"><h3><a href="#var-hsts-headers">hsts-headers</a></h3><div class="usage"><code>(hsts-headers)</code><code>(hsts-headers {:keys [max-age subdomains], :or {max-age 31536000, subdomains true}})</code></div><div class="doc"><div class="markdown"><p>A chain handler that adds the Strict-Transport-Security header to the response. This accepts the following params:</p>
<ul>
  <li><code>max-age</code>: the max time in seconds for the policy (default: 1 year)</li>
  <li><code>subdomains</code>: include subdomains or not (default true)</li>
</ul><p>For more information, see the following rfc: <a href="https://tools.ietf.org/html/rfc6797">https://tools.ietf.org/html/rfc6797</a></p></div></div><div class="src-link"><a href="http://github.com/funcool/catacumba/blob/master/src/clojure/catacumba/handlers/security.clj#L34">view source</a></div></div></section></section></body></html>